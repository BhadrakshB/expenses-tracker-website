---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import PricingCard from '../components/PricingCard.astro';
import FAQAccordion from '../components/FAQAccordion.astro';
import SectionHeading from '../components/SectionHeading.astro';
import BrutalButton from '../components/BrutalButton.astro';

const freeFeatures = [
  { text: 'Unlimited expenses', included: true },
  { text: 'Categories & tags', included: true },
  { text: '1 bank account', included: true },
  { text: 'Offline storage', included: true },
  { text: 'CSV export (1√ó/week)', included: true },
  { text: 'Biometric lock', included: true },
  { text: 'Cloud sync', included: false },
  { text: 'AI insights', included: false },
  { text: 'SMS tracking', included: false },
  { text: 'Bill reminders', included: false },
];

const proFeatures = [
  { text: 'Everything in Free', included: true },
  { text: 'Unlimited bank accounts', included: true },
  { text: 'Cloud sync across devices', included: true },
  { text: 'AI-powered insights', included: true },
  { text: 'Automatic SMS tracking', included: true },
  { text: 'Bill & EMI reminders', included: true },
  { text: 'Family sharing (up to 5)', included: true },
  { text: 'Unlimited exports', included: true },
  { text: 'Priority support', included: true },
  { text: 'Early access to features', included: true },
];

const faqs = [
  {
    question: 'What happens when my trial ends?',
    answer: 'You\'ll automatically switch to the Free plan. <strong>No charges</strong>. All your data remains safe, but Pro features become unavailable until you upgrade.'
  },
  {
    question: 'Can I cancel anytime?',
    answer: 'Absolutely! Cancel anytime from your device\'s subscription settings. You\'ll retain Pro access until the end of your billing period.'
  },
  {
    question: 'How do refunds work?',
    answer: 'We offer a <strong>14-day full refund</strong> policy. If you\'re not satisfied, contact us or request a refund through the App Store/Play Store. See our <a href="/refunds">refund policy</a> for details.'
  },
  {
    question: 'Is my financial data secure?',
    answer: 'Your security is our priority. We use <strong>TLS 1.3</strong> encryption in transit and <strong>AES-256</strong> encryption at rest. We never sell your data and follow GDPR/CCPA guidelines.'
  },
  {
    question: 'Does the app work offline?',
    answer: 'Yes! Both Free and Pro work fully offline. Pro users get automatic sync when connected. Your data is always available, internet or not.'
  },
  {
    question: 'How does family sharing work?',
    answer: 'Pro subscribers can invite up to 5 family members. Each gets their own account with full Pro features. Share budgets and track household expenses together.'
  },
];

const jsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": faqs.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer.replace(/<[^>]*>/g, '')
    }
  }))
};
---

<BaseLayout 
  title="Simple, Honest Pricing" 
  description="Choose the plan that fits your needs. Start free forever or unlock everything with Pro. 14-day free trial, cancel anytime."
  canonical="/pricing"
>
  <Fragment slot="structured-data">
    <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />
  </Fragment>
  
  <Header slot="header" />
  
  <!-- Pricing Hero -->
  <section class="pricing-hero">
    <div class="container">
      <h1 class="pricing-title">SIMPLE, HONEST<br/><span class="title-accent">PRICING</span></h1>
      <p class="pricing-subtitle">No hidden fees. No surprises. Cancel anytime.</p>
    </div>
  </section>
  
  <!-- Pricing Cards -->
  <section class="pricing-cards-section">
    <div class="container">
      <div class="pricing-grid">
        <PricingCard 
          name="Free"
          price="$0"
          description="Everything you need to get started"
          features={freeFeatures}
          ctaText="Download Free"
          ctaHref="https://apps.apple.com/app/expenses-tracker"
        />
        <PricingCard 
          name="Pro"
          price="$4.99"
          period="month"
          description="Unlock the full power of expense tracking"
          features={proFeatures}
          ctaText="Start 14-Day Free Trial"
          ctaHref="https://apps.apple.com/app/expenses-tracker"
          highlighted
          badge="Most Popular"
        />
      </div>
      
      <div class="yearly-offer">
        <div class="offer-badge">SAVE 20%</div>
        <p class="offer-text">
          Pay yearly for <strong>$49.99/year</strong> 
          <span class="offer-savings">(That's $4.17/month)</span>
        </p>
      </div>
    </div>
  </section>
  
  <!-- Regional Pricing -->
  <section class="regional-pricing">
    <div class="container">
      <div class="regional-banner">
        <div class="regional-icon">üåç</div>
        <div class="regional-content">
          <h3 class="regional-title">Regional Pricing Available</h3>
          <p class="regional-text">
            We offer fair pricing based on your location.
            <span class="regional-examples">
              üáÆüá≥ India: ‚Çπ249/mo &nbsp;‚Ä¢&nbsp; 
              üáßüá∑ Brazil: R$19.99/mo &nbsp;‚Ä¢&nbsp;
              üáÆüá© Indonesia: Rp49,000/mo
            </span>
          </p>
        </div>
      </div>
    </div>
  </section>
  
  <!-- FAQ Section -->
  <section class="faq-section section-dark">
    <div class="container container-narrow">
      <SectionHeading 
        title="Questions?" 
        subtitle="Everything you need to know about Expenses Tracker Pro."
        align="center"
      />
      <div class="faq-list">
        {faqs.map(faq => (
          <FAQAccordion question={faq.question} answer={faq.answer} />
        ))}
      </div>
    </div>
  </section>
  
  <!-- Guarantee Banner -->
  <section class="guarantee-section">
    <div class="container">
      <div class="guarantee-banner">
        <div class="guarantee-icon">üõ°Ô∏è</div>
        <div class="guarantee-content">
          <h3 class="guarantee-title">30-Day Money-Back Guarantee</h3>
          <p class="guarantee-text">
            Not happy? Get a full refund within 30 days. No questions asked.
            We're confident you'll love Pro, but if not, we've got you covered.
          </p>
        </div>
        <BrutalButton href="/refunds" variant="secondary" size="sm">
          Learn More
        </BrutalButton>
      </div>
    </div>
  </section>
  
  <Footer slot="footer" />
</BaseLayout>

<style>
  /* Pricing Hero */
  .pricing-hero {
    padding-block: clamp(4rem, 10vh, 6rem) clamp(2rem, 5vh, 4rem);
    text-align: center;
  }
  
  .pricing-title {
    font-size: clamp(2.5rem, 8vw, 5rem);
    font-weight: 900;
    line-height: 1;
    letter-spacing: -0.03em;
    margin-bottom: 1rem;
  }
  
  .title-accent {
    color: var(--accent-primary);
  }
  
  .pricing-subtitle {
    font-size: 1.25rem;
    color: var(--text-secondary);
  }
  
  /* Pricing Cards */
  .pricing-cards-section {
    padding-block: 2rem 4rem;
  }
  
  .pricing-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    max-width: 900px;
    margin: 0 auto;
  }
  
  @media (min-width: 768px) {
    .pricing-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  .yearly-offer {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-top: 2rem;
    padding: 1rem 1.5rem;
    background: var(--background-secondary);
    border: 2px dashed var(--accent-primary);
    max-width: 500px;
    margin-inline: auto;
  }
  
  .offer-badge {
    background: var(--accent-primary);
    color: var(--background-primary);
    font-family: 'Manrope', system-ui, sans-serif;
    font-weight: 800;
    font-size: 0.625rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 0.375rem 0.75rem;
    white-space: nowrap;
  }
  
  .offer-text {
    font-size: 0.9375rem;
    color: var(--text-secondary);
  }
  
  .offer-text strong {
    color: var(--text-primary);
  }
  
  .offer-savings {
    color: var(--text-muted);
    font-size: 0.8125rem;
  }
  
  /* Regional Pricing */
  .regional-pricing {
    padding-block: 2rem;
  }
  
  .regional-banner {
    display: flex;
    align-items: flex-start;
    gap: 1.5rem;
    padding: 1.5rem;
    background: var(--background-secondary);
    border: 3px solid var(--text-muted);
    max-width: 700px;
    margin: 0 auto;
  }
  
  .regional-icon {
    font-size: 2rem;
    flex-shrink: 0;
  }
  
  .regional-title {
    font-family: 'Manrope', system-ui, sans-serif;
    font-size: 1rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    margin-bottom: 0.5rem;
  }
  
  .regional-text {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    line-height: 1.6;
  }
  
  .regional-examples {
    display: block;
    margin-top: 0.5rem;
    font-size: 0.8125rem;
    color: var(--text-muted);
  }
  
  /* FAQ Section */
  .faq-section {
    padding-block: clamp(4rem, 10vh, 6rem);
  }
  
  .faq-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }
  
  /* Guarantee Section */
  .guarantee-section {
    padding-block: clamp(3rem, 8vh, 5rem);
  }
  
  .guarantee-banner {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    padding: 2rem;
    background: var(--background-secondary);
    border: 4px solid var(--success);
    text-align: center;
    max-width: 700px;
    margin: 0 auto;
  }
  
  @media (min-width: 768px) {
    .guarantee-banner {
      flex-direction: row;
      text-align: left;
    }
  }
  
  .guarantee-icon {
    font-size: 3rem;
    flex-shrink: 0;
  }
  
  .guarantee-content {
    flex-grow: 1;
  }
  
  .guarantee-title {
    font-family: 'Manrope', system-ui, sans-serif;
    font-size: 1.125rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    margin-bottom: 0.5rem;
    color: var(--success);
  }
  
  .guarantee-text {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    line-height: 1.6;
  }
</style>
